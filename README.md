# MastersDissertation_HIVDataAnalysis_25
This repository contains code used for my masters dissertation on Quantitative analysis of suspected HIV proviral DNA reads observed from the strand-specific HIV RNA metagenomic libraries. 
This dissertation was conceptualized, written and submitted between May 2025 to July 2025

The steps of my work that used custom Python code are:
1. Strand-specific BAM Coverage Analysis (Code: LogCoverage_and_Coverage_ratios.py)
2. Summary plot of Pacbio read percentages (Code: Summary_of_Pacbio_read_percentages.py)





The python codes I used for each step of my analysis are documented here for reproducibility
   

# Step 1: Strand-Specific BAM Coverage Analysis

Python pipeline for separating BAM reads by strand, computing per-base coverage, and visualizing strand bias in HIV sequencing datasets (for example, HIV proviral integration studies).
See LogCoverage_and_Coverage_ratios.py for code used

## Key Features

- Separates forward and reverse reads into distinct BAM files.
- Computes per-base genome-wide coverage (log₁₀-scaled).
- Plots strand-specific coverage profiles.
- Calculates and visualizes the forward/reverse strand coverage ratio.
- Outputs tabulated per-position coverage and ratios.
- Fully automated for batch processing multiple samples.

## Why Use This?

In strand-specific studies (e.g. HIV proviral detection, transcriptomics), it's critical to distinguish the orientation of aligned reads. 
This tool enables quick, reproducible inspection of strand bias across reference genomes.

---

## Requirements

- Python version 3.12.3

  ## Dependencies
- pysam (https://pysam.readthedocs.io/)
- matplotlib.pyplot
- numpy

  Install dependencies with:
pip install pysam matplotlib numpy (on bash)

  ## Input

- A directory of **sorted and indexed BAM files**

  ## Example output
- A log coverage plot showing coverage of forward reads (marked blue) versus reverse reads (marked red)
- A coverage ratio graph fowing the forward:reverse strand ratios at each position across the genome
- A `strand_summary.txt` file and a `coverage_table.tsv` showing the ratio of forward:reverse reads at each position in the genome

  ## Usage

```bash
python LogCoverage_and_Coverage_ratios.py --input_dir bam_folder --output_dir coverage_outputs


Install requirements via pip:

```bash
pip install matplotlib numpy
```
# Step 2: Summary plot of Pacbio read percentages

This script visualizes the proportion of **forward vs. reverse strand reads** across different sample sets based on strand-specific summary statistics.

It parses `strand_summary.txt` files (generated by a prior BAM processing script) and produces a **stacked bar plot** showing the percentage of reads aligned to each strand per sample.

See Summary_of_Pacbio_read_percentages.py for the code used

---

## Example Output

Each sample is represented by a bar divided into:
- **Forward strand reads** (top, blue)
- **Reverse strand reads** (bottom, red)
Percentages are displayed on the bars for easy interpretation.
---

## Requirements

- Python 3.7 and above
- `matplotlib`
- `numpy`

Install requirements via pip:

```bash
pip install matplotlib numpy
```


 
